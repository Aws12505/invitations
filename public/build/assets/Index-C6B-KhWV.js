import{j as e,r as o,a as S,H as W,L as $}from"./app-CtcDIlsc.js";import{A as Z}from"./app-layout-h9UkTarG.js";import{B as x}from"./button-BWNuTd8n.js";import{C as m,a as h,b as u,c as j,d as ee}from"./card-BNkVdPxa.js";import{B as v}from"./badge-CgSmYn1Z.js";import{T as se,a as te,b as F,c as r,d as ae,e as n}from"./table-DRTmVstP.js";import{I as le}from"./input-DSSrxwpi.js";import{S as _,a as A,b as k,c as D,d as a}from"./select-T_x3JwjR.js";import{T as ne,A as re,a as ie,b as de,c as ce,d as oe,e as xe,f as me,g as he}from"./alert-dialog-EHQ24MiB.js";import{D as ue,Q as je}from"./QrCodeDisplay-CqV3lk9M.js";import{C as pe}from"./ChairDisplay-Dw8jiXNf.js";import{t as p}from"./index-CY9GR9YH.js";import{P as fe,a as ge,b as T,c as Ne,d as ve,e as be,f as ye,E as we}from"./pagination-CbLNTvtj.js";import{U as B}from"./users-DVkxot4G.js";import{U as E}from"./user-check-B3fVcHJ0.js";import{c as H}from"./createLucideIcon-GVte-zZo.js";import{S as Ce}from"./search-QcEyNEOy.js";import{P as Se}from"./phone-Dy_sP-_h.js";import{U as _e}from"./user-x-DK_-IYc9.js";import{C as Ae,E as ke,S as De}from"./square-pen-DU-Soc4F.js";/* empty css            */import"./index-DOG0P_Jw.js";import"./index-SFZIEt5i.js";import"./index-CC7XR_KE.js";import"./index-Bvl3ChLw.js";import"./index-ybkMdk5e.js";import"./index-SWHS4kFd.js";import"./app-logo-icon-DtBuXxU-.js";import"./check-CoK5Tjyc.js";import"./dialog-DcShTMBr.js";import"./armchair-CtMSput-.js";import"./crown-Dlzh6RR5.js";import"./user-CwDGMHL4.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],Ie=H("Filter",Te);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Fe=H("ShieldQuestion",Pe);function Ee({data:l}){const{links:t,current_page:d,last_page:I,prev_page_url:c,next_page_url:f}=l;return I<=1?null:e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsxs("div",{className:"flex-1 text-sm text-muted-foreground",children:["Showing ",l.from||0," to ",l.to||0," of ",l.total," attendants"]}),e.jsx(fe,{children:e.jsxs(ge,{children:[c&&e.jsx(T,{children:e.jsx(Ne,{href:c})}),t&&t.slice(1,-1).map((i,g)=>i.label==="..."?e.jsx(T,{children:e.jsx(ve,{})},g):e.jsx(T,{children:e.jsx(be,{href:i.url||"#",isActive:i.active,children:i.label})},g)),f&&e.jsx(T,{children:e.jsx(ye,{href:f})})]})})]})}const Le=[{title:"Attendants",href:"#"}];function js({attendants:l,statistics:t,filters:d,invitationLinks:I}){const[c,f]=o.useState(d.search||""),[i,g]=o.useState(d.attendance_status||"all"),[b,L]=o.useState(d.vip_status||"all"),[y,M]=o.useState(d.attended||"all"),[w,V]=o.useState(d.invitation_link_id?.toString()||"all"),[C,R]=o.useState({open:!1,attendantId:null,attendantName:""});o.useEffect(()=>{const s=setTimeout(()=>{U()},300);return()=>clearTimeout(s)},[c]),o.useEffect(()=>{U()},[i,b,y,w]);const U=()=>{const s=new URLSearchParams(window.location.search);c&&c.trim()?s.set("search",c):s.delete("search"),i!=="all"?s.set("attendance_status",i):s.delete("attendance_status"),b!=="all"?s.set("vip_status",b):s.delete("vip_status"),y!=="all"?s.set("attended",y):s.delete("attended"),w!=="all"?s.set("invitation_link_id",w):s.delete("invitation_link_id"),s.delete("page"),S.get("/attendants",Object.fromEntries(s),{preserveState:!0,preserveScroll:!0})},O=s=>{const N=`${window.location.origin}/status/${s}`;navigator.clipboard.writeText(N).then(()=>{p.success("Status link copied to clipboard!")}).catch(()=>{p.error("Failed to copy status link")})},Q=(s,N)=>{R({open:!0,attendantId:s,attendantName:N})},P=()=>{R({open:!1,attendantId:null,attendantName:""})},q=()=>{C.attendantId&&S.delete(`/attendants/${C.attendantId}`,{onSuccess:()=>{p.success("Attendant deleted successfully"),P()},onError:()=>{p.error("Failed to delete attendant")}})},X=(s,N)=>{S.patch(`/attendants/${s}/toggle-attended`,{},{onSuccess:()=>{const K=!N?"Attendant marked as attended":"Attendant marked as not attended";p.success(K)},onError:z=>{p.error(z.attended||"Failed to update attendance status")}})},Y=s=>{switch(s){case"coming":return e.jsx(v,{className:"bg-green-100 text-green-800 border-green-200",children:"Coming"});case"maybe":return e.jsx(v,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"Maybe"});case"not_coming":return e.jsx(v,{className:"bg-red-100 text-red-800 border-red-200",children:"Not Coming"});default:return e.jsx(v,{variant:"outline",children:"No Response"})}},G=()=>{const s=new URLSearchParams(window.location.search);s.set("export","csv"),window.location.href=`/attendants?${s.toString()}`},J=()=>{f(""),g("all"),L("all"),M("all"),V("all"),S.get("/attendants",{},{preserveState:!0,preserveScroll:!0})};return e.jsxs(Z,{breadcrumbs:Le,children:[e.jsx(W,{title:"Attendants"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Attendants"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage event attendants and track their status"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(x,{variant:"outline",onClick:G,children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Export CSV"]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Total Attendants"}),e.jsx(B,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(j,{children:e.jsx("div",{className:"text-2xl font-bold",children:t.total})})]}),e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Coming"}),e.jsx(E,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.coming}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.total>0?Math.round(t.coming/t.total*100):0,"% of total"]})]})]}),e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Maybe/No Response"}),e.jsx(Fe,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.maybe+t.no_response}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.maybe," maybe, ",t.no_response," no response"]})]})]}),e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Actually Attended"}),e.jsx(E,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.attended}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.total>0?Math.round(t.attended/t.total*100):0,"% attendance rate"]})]})]})]}),e.jsxs(m,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-5 w-5"}),"Filters"]}),e.jsx(x,{variant:"outline",size:"sm",onClick:J,children:"Clear All"})]})}),e.jsxs(j,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ce,{className:"h-4 w-4 absolute left-3 top-3 text-muted-foreground"}),e.jsx(le,{placeholder:"Search by name, phone, or inviter...",value:c,onChange:s=>f(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Attendance Status"}),e.jsxs(_,{value:i,onValueChange:g,children:[e.jsx(A,{children:e.jsx(k,{})}),e.jsxs(D,{children:[e.jsx(a,{value:"all",children:"All Status"}),e.jsx(a,{value:"coming",children:"Coming"}),e.jsx(a,{value:"maybe",children:"Maybe"}),e.jsx(a,{value:"not_coming",children:"Not Coming"}),e.jsx(a,{value:"no_response",children:"No Response"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"VIP Status"}),e.jsxs(_,{value:b,onValueChange:L,children:[e.jsx(A,{children:e.jsx(k,{})}),e.jsxs(D,{children:[e.jsx(a,{value:"all",children:"All VIP"}),e.jsx(a,{value:"regular",children:"Regular"}),e.jsx(a,{value:"vip",children:"VIP"}),e.jsx(a,{value:"premium",children:"Premium"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Actually Attended"}),e.jsxs(_,{value:y,onValueChange:M,children:[e.jsx(A,{children:e.jsx(k,{})}),e.jsxs(D,{children:[e.jsx(a,{value:"all",children:"All"}),e.jsx(a,{value:"attended",children:"Attended"}),e.jsx(a,{value:"not_attended",children:"Not Attended"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Invited By"}),e.jsxs(_,{value:w,onValueChange:V,children:[e.jsx(A,{children:e.jsx(k,{})}),e.jsxs(D,{children:[e.jsx(a,{value:"all",children:"All Inviters"}),I.map(s=>e.jsxs(a,{value:s.id.toString(),children:[s.full_name," (",s.usage," attendants)"]},s.id))]})]})]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:["Showing ",l.pagination.from||0," to ",l.pagination.to||0," of ",l.pagination.total," attendants",Object.keys(d).length>0&&" (filtered)"]})]})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Attendants List"}),e.jsx(ee,{children:"Complete list of event attendants with their status and details"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(F,{children:[e.jsx(r,{children:"Name"}),e.jsx(r,{children:"Phone"}),e.jsx(r,{children:"Invited By"}),e.jsx(r,{children:"VIP Status"}),e.jsx(r,{children:"Chair"}),e.jsx(r,{children:"Response"}),e.jsx(r,{children:"Attended"}),e.jsx(r,{children:"Registered"}),e.jsx(r,{className:"text-right",children:"Actions"}),e.jsx(r,{className:"text-center",children:"QR Code"})]})}),e.jsx(ae,{children:l.data.length>0?l.data.map(s=>e.jsxs(F,{children:[e.jsx(n,{className:"font-medium",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.full_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ID: ",s.id]})]})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("a",{href:`tel:${s.phone_number}`,className:"text-blue-600 hover:underline",children:s.phone_number})]})}),e.jsx(n,{children:s.invitation_link?.full_name||"Unknown"}),e.jsx(n,{children:e.jsx(v,{variant:s.vip_status==="vip"?"default":"secondary",children:s.vip_status.toUpperCase()})}),e.jsx(n,{children:e.jsx(pe,{chairNumber:s.chair_number,size:"sm",showSection:!0})}),e.jsx(n,{children:Y(s.attendance_status)}),e.jsx(n,{children:e.jsx(x,{variant:s.attended?"default":"outline",size:"sm",onClick:()=>X(s.id,s.attended),className:"min-w-[80px]",children:s.attended?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-3 w-3 mr-1"})," Yes"]}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"h-3 w-3 mr-1"})," No"]})})}),e.jsx(n,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{children:new Date(s.created_at).toLocaleDateString()}),e.jsx("p",{className:"text-muted-foreground",children:new Date(s.created_at).toLocaleTimeString()})]})}),e.jsx(n,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(x,{variant:"outline",size:"sm",onClick:()=>O(s.status_token),title:"Copy status link",children:e.jsx(Ae,{className:"h-3 w-3"})}),e.jsx(x,{variant:"outline",size:"sm",asChild:!0,title:"Open status page",children:e.jsx("a",{href:`/status/${s.status_token}`,target:"_blank",rel:"noopener noreferrer",children:e.jsx(ke,{className:"h-3 w-3"})})}),e.jsx(x,{variant:"outline",size:"sm",asChild:!0,title:"View details",children:e.jsx($,{href:`/attendants/${s.id}`,children:e.jsx(we,{className:"h-3 w-3"})})}),e.jsx(x,{variant:"outline",size:"sm",asChild:!0,title:"Edit attendant",children:e.jsx($,{href:`/attendants/${s.id}/edit`,children:e.jsx(De,{className:"h-3 w-3"})})}),e.jsx(x,{variant:"outline",size:"sm",onClick:()=>Q(s.id,s.full_name),title:"Delete attendant",className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(ne,{className:"h-3 w-3"})})]})}),e.jsx(n,{className:"text-center",children:e.jsx(je,{attendant:s,size:"sm"})})]},s.id)):e.jsx(F,{children:e.jsx(n,{colSpan:10,className:"text-center py-8",children:e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx(B,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("p",{children:"No attendants found"}),e.jsx("p",{className:"text-sm",children:Object.keys(d).length>0?"Try adjusting your filters":"No attendants have registered yet"})]})})})})]})}),e.jsx(Ee,{data:l.pagination})]})]})]}),e.jsx(re,{open:C.open,onOpenChange:P,children:e.jsxs(ie,{children:[e.jsxs(de,{children:[e.jsx(ce,{children:"Are you sure you want to delete this attendant?"}),e.jsxs(oe,{children:["This will permanently delete ",e.jsx("strong",{children:C.attendantName}),"'s registration. This action cannot be undone and will also decrease the invitation link's usage count."]})]}),e.jsxs(xe,{children:[e.jsx(me,{onClick:P,children:"Cancel"}),e.jsx(he,{onClick:q,className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",children:"Delete Attendant"})]})]})})]})}export{js as default};
