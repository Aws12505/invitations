import{j as e,r as b,H as X,L as R,a as U}from"./app-CEfohHKB.js";import{A as G}from"./app-layout-CC3uUAH6.js";import{B as h}from"./button-Cf5OBkvA.js";import{C as j,a as p,b as f,c as g,d as J}from"./card-DMFakVEY.js";import{B as w}from"./badge-BlVQMdEv.js";import{T as K,a as W,b as P,c as n,d as Z,e as a}from"./table-CqRVqrws.js";import{I as ee}from"./input-OA3X1roX.js";import{S as T,a as I,b as L,c as F,d as l}from"./select-CN3NJnn3.js";import{T as se,A as te,a as ae,b as le,c as ne,d as re,e as ie,f as de,g as oe}from"./alert-dialog-BldvVgaX.js";import{D as ce,Q as me}from"./QrCodeDisplay-C6-AtLcd.js";import{C as xe}from"./ChairDisplay-B12EVqUu.js";import{t as N}from"./index-BC4llrPh.js";import{P as he,a as ue,b as S,c as je,d as pe,e as fe,f as ge,E as Ne}from"./pagination-Dah_nz8r.js";import{U as E}from"./users-DfqPc22M.js";import{U as V}from"./user-check-qRS9TOto.js";import{c as z}from"./createLucideIcon-C1kX6QOl.js";import{S as ve}from"./search-JqIVSeV_.js";import{P as be}from"./phone-Dc2YRQxz.js";import{U as we}from"./user-x-B02zID5d.js";import{C as ye,E as Ce,S as _e}from"./square-pen-C_JLgWe0.js";/* empty css            */import"./index-CLlSA1CH.js";import"./index-M3sdbAMS.js";import"./index-DtccALi-.js";import"./index-ZcBk-nth.js";import"./index-DZhwA5oI.js";import"./index-BwMU0Zd6.js";import"./app-logo-icon-Dulel9Vy.js";import"./armchair-BkyA-nFG.js";import"./check-DqSP4QnI.js";import"./dialog-C4-5XeL2.js";import"./crown-Dyu7jJrT.js";import"./user-B8sFi2rB.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],Se=z("Filter",Ae);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}],["path",{d:"M12 17h.01",key:"p32p05"}]],De=z("ShieldQuestion",ke);function Pe({data:o}){const{links:t,current_page:u,last_page:k,prev_page_url:c,next_page_url:y}=o;return k<=1?null:e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsxs("div",{className:"flex-1 text-sm text-muted-foreground",children:["Showing ",o.from||0," to ",o.to||0," of ",o.total," attendants"]}),e.jsx(he,{children:e.jsxs(ue,{children:[c&&e.jsx(S,{children:e.jsx(je,{href:c})}),t&&t.slice(1,-1).map((r,C)=>r.label==="..."?e.jsx(S,{children:e.jsx(pe,{})},C):e.jsx(S,{children:e.jsx(fe,{href:r.url||"#",isActive:r.active,children:r.label})},C)),y&&e.jsx(S,{children:e.jsx(ge,{href:y})})]})})]})}const Te=[{title:"Attendants",href:"#"}];function ms({attendants:o,statistics:t}){const[u,k]=b.useState(""),[c,y]=b.useState("all"),[r,C]=b.useState("all"),[v,B]=b.useState("all"),[_,M]=b.useState({open:!1,attendantId:null,attendantName:""}),A=o.data.filter(s=>{const i=s.full_name.toLowerCase().includes(u.toLowerCase())||s.phone_number.includes(u)||(s.invitation_link?.full_name||"").toLowerCase().includes(u.toLowerCase()),m=c==="all"||s.attendance_status===c,x=r==="all"||s.vip_status===r,d=v==="all"||v==="attended"&&s.attended||v==="not_attended"&&!s.attended;return i&&m&&x&&d}),$=s=>{const i=`${window.location.origin}/status/${s}`;navigator.clipboard.writeText(i).then(()=>{N.success("Status link copied to clipboard!")}).catch(()=>{N.error("Failed to copy status link")})},H=(s,i)=>{M({open:!0,attendantId:s,attendantName:i})},D=()=>{M({open:!1,attendantId:null,attendantName:""})},Q=()=>{_.attendantId&&U.delete(`/attendants/${_.attendantId}`,{onSuccess:()=>{N.success("Attendant deleted successfully"),D()},onError:()=>{N.error("Failed to delete attendant")}})},O=(s,i)=>{U.patch(`/attendants/${s}/toggle-attended`,{},{onSuccess:()=>{const x=!i?"Attendant marked as attended":"Attendant marked as not attended";N.success(x)},onError:m=>{N.error(m.attended||"Failed to update attendance status")}})},Y=s=>{switch(s){case"coming":return e.jsx(w,{className:"bg-green-100 text-green-800 border-green-200",children:"Coming"});case"maybe":return e.jsx(w,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"Maybe"});case"not_coming":return e.jsx(w,{className:"bg-red-100 text-red-800 border-red-200",children:"Not Coming"});default:return e.jsx(w,{variant:"outline",children:"No Response"})}},q=()=>{const s=[["Name","Phone","VIP Status","Chair Assignments","Attendance Status","Attended","Invited By"].join(","),...A.map(d=>[d.full_name,d.phone_number,d.vip_status,d.chair_number||"No Chair Assigned",d.attendance_status||"No Response",d.attended?"Yes":"No",d.invitation_link?.full_name||""].join(","))].join(`
`),i=new Blob([s],{type:"text/csv"}),m=window.URL.createObjectURL(i),x=document.createElement("a");x.href=m,x.download="attendants.csv",x.click(),window.URL.revokeObjectURL(m)};return e.jsxs(G,{breadcrumbs:Te,children:[e.jsx(X,{title:"Attendants"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Attendants"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage event attendants and track their status"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(h,{variant:"outline",onClick:q,children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Export CSV"]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(j,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium",children:"Total Attendants"}),e.jsx(E,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(g,{children:e.jsx("div",{className:"text-2xl font-bold",children:t.total})})]}),e.jsxs(j,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium",children:"Coming"}),e.jsx(V,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.coming}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.total>0?Math.round(t.coming/t.total*100):0,"% of total"]})]})]}),e.jsxs(j,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium",children:"Maybe/No Response"}),e.jsx(De,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.maybe+t.no_response}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.maybe," maybe, ",t.no_response," no response"]})]})]}),e.jsxs(j,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium",children:"Actually Attended"}),e.jsx(V,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.attended}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.total>0?Math.round(t.attended/t.total*100):0,"% attendance rate"]})]})]})]}),e.jsxs(j,{children:[e.jsx(p,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-5 w-5"}),"Filters"]})}),e.jsxs(g,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(ve,{className:"h-4 w-4 absolute left-3 top-3 text-muted-foreground"}),e.jsx(ee,{placeholder:"Search by name, phone, or inviter...",value:u,onChange:s=>k(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Attendance Status"}),e.jsxs(T,{value:c,onValueChange:y,children:[e.jsx(I,{children:e.jsx(L,{})}),e.jsxs(F,{children:[e.jsx(l,{value:"all",children:"All Status"}),e.jsx(l,{value:"coming",children:"Coming"}),e.jsx(l,{value:"maybe",children:"Maybe"}),e.jsx(l,{value:"not_coming",children:"Not Coming"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"VIP Status"}),e.jsxs(T,{value:r,onValueChange:C,children:[e.jsx(I,{children:e.jsx(L,{})}),e.jsxs(F,{children:[e.jsx(l,{value:"all",children:"All VIP"}),e.jsx(l,{value:"regular",children:"Regular"}),e.jsx(l,{value:"vip",children:"VIP"}),e.jsx(l,{value:"premium",children:"Premium"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Actually Attended"}),e.jsxs(T,{value:v,onValueChange:B,children:[e.jsx(I,{children:e.jsx(L,{})}),e.jsxs(F,{children:[e.jsx(l,{value:"all",children:"All"}),e.jsx(l,{value:"attended",children:"Attended"}),e.jsx(l,{value:"not_attended",children:"Not Attended"})]})]})]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:["Showing ",A.length," of ",o.pagination.total," attendants (filtered from current page)"]})]})]}),e.jsxs(j,{children:[e.jsxs(p,{children:[e.jsx(f,{children:"Attendants List"}),e.jsx(J,{children:"Complete list of event attendants with their status and details"})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(K,{children:[e.jsx(W,{children:e.jsxs(P,{children:[e.jsx(n,{children:"Name"}),e.jsx(n,{children:"Phone"}),e.jsx(n,{children:"Invited By"}),e.jsx(n,{children:"VIP Status"}),e.jsx(n,{children:"Chair"}),e.jsx(n,{children:"Response"}),e.jsx(n,{children:"Attended"}),e.jsx(n,{children:"Registered"}),e.jsx(n,{className:"text-right",children:"Actions"}),e.jsx(n,{className:"text-center",children:"QR Code"})]})}),e.jsx(Z,{children:A.length>0?A.map(s=>e.jsxs(P,{children:[e.jsx(a,{className:"font-medium",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.full_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ID: ",s.id]})]})}),e.jsx(a,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("a",{href:`tel:${s.phone_number}`,className:"text-blue-600 hover:underline",children:s.phone_number})]})}),e.jsx(a,{children:s.invitation_link?.full_name||"Unknown"}),e.jsx(a,{children:e.jsx(w,{variant:s.vip_status==="vip"?"default":"secondary",children:s.vip_status.toUpperCase()})}),e.jsx(a,{children:e.jsx(xe,{chairNumber:s.chair_number,size:"sm",showSection:!0})}),e.jsx(a,{children:Y(s.attendance_status)}),e.jsx(a,{children:e.jsx(h,{variant:s.attended?"default":"outline",size:"sm",onClick:()=>O(s.id,s.attended),className:"min-w-[80px]",children:s.attended?e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"h-3 w-3 mr-1"})," Yes"]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"h-3 w-3 mr-1"})," No"]})})}),e.jsx(a,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{children:new Date(s.created_at).toLocaleDateString()}),e.jsx("p",{className:"text-muted-foreground",children:new Date(s.created_at).toLocaleTimeString()})]})}),e.jsx(a,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(h,{variant:"outline",size:"sm",onClick:()=>$(s.status_token),title:"Copy status link",children:e.jsx(ye,{className:"h-3 w-3"})}),e.jsx(h,{variant:"outline",size:"sm",asChild:!0,title:"Open status page",children:e.jsx("a",{href:`/status/${s.status_token}`,target:"_blank",rel:"noopener noreferrer",children:e.jsx(Ce,{className:"h-3 w-3"})})}),e.jsx(h,{variant:"outline",size:"sm",asChild:!0,title:"View details",children:e.jsx(R,{href:`/attendants/${s.id}`,children:e.jsx(Ne,{className:"h-3 w-3"})})}),e.jsx(h,{variant:"outline",size:"sm",asChild:!0,title:"Edit attendant",children:e.jsx(R,{href:`/attendants/${s.id}/edit`,children:e.jsx(_e,{className:"h-3 w-3"})})}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>H(s.id,s.full_name),title:"Delete attendant",className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(se,{className:"h-3 w-3"})})]})}),e.jsx(a,{className:"text-center",children:e.jsx(me,{attendant:s,size:"sm"})})]},s.id)):e.jsx(P,{children:e.jsx(a,{colSpan:8,className:"text-center py-8",children:e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx(E,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("p",{children:"No attendants found"}),e.jsx("p",{className:"text-sm",children:u||c!=="all"||r!=="all"||v!=="all"?"Try adjusting your filters":"No attendants have registered yet"})]})})})})]})}),e.jsx(Pe,{data:o.pagination})]})]})]}),e.jsx(te,{open:_.open,onOpenChange:D,children:e.jsxs(ae,{children:[e.jsxs(le,{children:[e.jsx(ne,{children:"Are you sure you want to delete this attendant?"}),e.jsxs(re,{children:["This will permanently delete ",e.jsx("strong",{children:_.attendantName}),"'s registration. This action cannot be undone and will also decrease the invitation link's usage count."]})]}),e.jsxs(ie,{children:[e.jsx(de,{onClick:D,children:"Cancel"}),e.jsx(oe,{onClick:Q,className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",children:"Delete Attendant"})]})]})})]})}export{ms as default};
